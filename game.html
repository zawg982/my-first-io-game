<!DOCTYPE html>
<html>
<head>
  <title>Retro Dodge â€“ Game</title>
  <style>
    body {
      margin: 0;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    canvas {
      border: 2px solid #00ffcc;
      border-radius: 16px;
      box-shadow: 0 0 20px #00ffaa;
      background-color: #000;
    }

    #scoreDisplay {
      position: absolute;
      top: 20px;
      left: 20px;
      font-family: monospace;
      color: #00ffcc;
      font-size: 18px;
      text-shadow: 0 0 4px #00ffaa;
    }
  </style>
</head>
<body>
  <canvas id="game" width="400" height="600"></canvas>
  <div id="scoreDisplay">Score: 0</div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("scoreDisplay");

    let player = { x: 180, y: 560, w: 40, h: 20, speed: 5 };
    let keys = {};
    let blocks = [];
    let powerUps = [];
    let frame = 0;
    let score = 0;
    let speedMultiplier = 1;

    document.addEventListener("keydown", (e) => keys[e.key] = true);
    document.addEventListener("keyup", (e) => keys[e.key] = false);

    function drawPlayer() {
      ctx.fillStyle = "#000";
      ctx.fillRect(player.x - 2, player.y - 2, player.w + 4, player.h + 4);
      ctx.fillStyle = "#00ffcc";
      ctx.fillRect(player.x, player.y, player.w, player.h);
    }

    function drawBlock(b) {
      ctx.fillStyle = "#000";
      ctx.fillRect(b.x - 2, b.y - 2, b.size + 4, b.size + 4);
      ctx.fillStyle = "#ff0044";
      ctx.fillRect(b.x, b.y, b.size, b.size);
    }

    function drawPowerUp(p) {
      ctx.beginPath();
      ctx.arc(p.x, p.y, 12, 0, Math.PI * 2);
      ctx.fillStyle = "#44ff00";
      ctx.fill();
      ctx.strokeStyle = "#000";
      ctx.lineWidth = 3;
      ctx.stroke();
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Move player
      if (keys["ArrowLeft"] && player.x > 0) player.x -= player.speed;
      if (keys["ArrowRight"] && player.x + player.w < canvas.width) player.x += player.speed;

      drawPlayer();

      // Add new blocks
      if (frame % Math.floor(60 / speedMultiplier) === 0) {
        let size = 30;
        blocks.push({
          x: Math.random() * (canvas.width - size),
          y: -size,
          size: size,
          speed: 2 + Math.random() * 3 * speedMultiplier
        });
      }

      // Random power-up
      if (frame % 300 === 0) {
        powerUps.push({
          x: 20 + Math.random() * 360,
          y: -20,
          speed: 2
        });
      }

      // Update blocks
      for (let i = 0; i < blocks.length; i++) {
        let b = blocks[i];
        b.y += b.speed;

        drawBlock(b);

        if (
          b.x < player.x + player.w &&
          b.x + b.size > player.x &&
          b.y < player.y + player.h &&
          b.y + b.size > player.y
        ) {
          alert("ðŸ’¥ GAME OVER\nScore: " + score);
          location.href = "index.html";
          return;
        }
      }

      // Update powerUps
      for (let i = 0; i < powerUps.length; i++) {
        let p = powerUps[i];
        p.y += p.speed;
        drawPowerUp(p);

        if (
          p.x > player.x &&
          p.x < player.x + player.w &&
          p.y > player.y &&
          p.y < player.y + player.h
        ) {
          powerUps.splice(i, 1);
          speedMultiplier = 0.5;
          setTimeout(() => speedMultiplier = 1, 3000);
        }
      }

      // Remove off-screen
      blocks = blocks.filter(b => b.y < canvas.height);
      powerUps = powerUps.filter(p => p.y < canvas.height);

      score++;
      scoreEl.textContent = "Score: " + score;

      frame++;
      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
